(()=>{"use strict";class s{constructor(s){this.destroyed=!1,this.mask=document.createElement("div"),this.dialog=document.createElement("dialog"),this.mask.classList.add("x-qrcode-dialog-mask"),this.mask.classList.add("x-qrcode-dialog-mask-open"),this.dialog.classList.add("x-qrcode-dialog"),this.dialog.classList.add("x-qrcode-dialog-open"),this.dialog.show||(this.dialog.show=()=>this.dialog.style.display="block"),this.dialog.close||(this.dialog.close=()=>this.dialog.style.display="none"),this.content(s);const e=()=>{this.mask.removeEventListener("click",e,!1),this.close()};this.mask.addEventListener("click",e,!1),document.body.appendChild(this.mask),document.body.appendChild(this.dialog)}content(s){this.destroyed||(this.dialog.innerHTML=s)}show(){this.destroyed||(this.dialog.show(),s.current=this)}close(){if(!this.destroyed){const e=()=>{this.mask.removeEventListener("animationend",e,!1),document.body.removeChild(this.mask)};this.mask.addEventListener("animationend",e,!1);const t=()=>{this.dialog.close(),this.dialog.removeEventListener("animationend",t,!1),document.body.removeChild(this.dialog)};this.dialog.addEventListener("animationend",t,!1),this.mask.classList.remove("x-qrcode-dialog-mask-open"),this.mask.classList.add("x-qrcode-dialog-mask-close"),this.dialog.classList.remove("x-qrcode-dialog-open"),this.dialog.classList.add("x-qrcode-dialog-close"),this.destroyed=!0,s.current===this&&(s.current=null)}}}s.current=null,chrome.runtime.onMessage.addListener((e=>{const t=new s;if(e.ok)switch(e.action){case"QRDecode":t.content(`<pre>${e.data}</pre>`);break;case"QREncodeLink":case"QREncodeSelection":t.content(`<img src="${e.src}" alt="QRCode" />`)}else t.content(`<pre class="error">${e.message}</pre>`);s.current&&s.current.close(),t.show()}))})();